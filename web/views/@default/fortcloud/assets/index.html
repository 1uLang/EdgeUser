<!-- 扫描报告 -->
{$layout}
{$var "header"}
{$end}
<div v-if="pageState==1">
    <div style="display: flex;height: 40px;border-bottom: 1px #f0f0f0 solid;width: 100%;padding-bottom: 10px;">
        <div style="cursor: pointer;margin-top: 10px;" @click="onChangeState(2)">[添加主机]</div>
    </div>
    
    <div style="width: 100%;height: 650px;margin-top: 10px;overflow-x: auto; overflow-y: auto;">
        <table id = "tab" class="ui table selectable celled" border="1" style="border-collapse: collapse;">
            <thead>
                <tr align="center">
                    <th class='table-head-bg' style="width: 248px;" >主机名</th>
                    <th class='table-head-bg' style="width: 165px;" >IP</th>
                    <th class='table-head-bg' style="width: 220px;" >硬件信息</th>
                    <th class='table-head-bg' style="width: 123px;" >连接状态</th>
                    <th class='table-head-bg' style="width: 113px;" >状态</th>
                    <th class='table-head-bg' style="width: 161px;" >更新时间</th>
                    <th class='table-head-bg' style="width: 151px;" >操作</th>
                </tr>
            </thead>
            <tbody id='tableBody'>
                <tr align="center" style="height: 40px;" v-for="(item,index) in tableData" >
                    <td @mouseenter="mouseEnter(index)" @mouseleave="mouseLeave(index)">
                        <div style="padding: 4px 0;">
                            <u v-show="index===curIndex && item.bAuth===0 " @click="onOpenDetail(item)" style="color: #169BD5;cursor: pointer;">{{item.value1}}</u>
                            <span v-show="index!=curIndex || (index===curIndex && item.bAuth===1)" style="color: #000;">{{item.value1}}</span>
                        </div>
                    </td>
                    <td>
                        <div style="padding: 4px 0;">
                            {{item.value2}}
                        </div>
                    </td>
                    <td>
                        <div style="padding: 4px 0;">
                            {{item.value3}}
                        </div>
                    </td>
                    <td>
                        <div style="padding: 4px 0;">
                            {{getLinkStatus(item.value4)}}
                        </div>
                    </td>
                    <td>
                        <div :class="{'status-open':item.value5=='1','status-close':item.value5=='0'}">
                            {{getStatus(item.value5)}}
                        </div>
                    </td>
                    <td>{{onChangeTimeFormat(item.value6)}}</td>
                    <td>
                        <div style="display: flex;justify-content: space-around;padding: 4px 0;">
                            <div v-if="item.value5===1" class="edit_btn" @click="onConnect(item.id)">连接</div>
                            <div class="edit_btn" @click="onOpenAuth(item.id)">授权</div>
                            <div class="edit_btn" @click="onEdit(item.id)">编辑</div>
                            <div class="edit_btn" @click="onDelete(item.id)">删除</div>
                        </div>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>    
</div>

<!-- 添加主机 -->
<div v-else-if="pageState==2">
    <div style="display: flex;height: 40px;border-bottom: 1px #f0f0f0 solid;width: 100%;padding-bottom: 10px;">
        <div style="display: inline-flex;margin-top: 10px;">
            <span style="cursor: pointer;" @click="onChangeState(1)">资产列表</span>
            <div style="margin-left: 20px;color: #0090cb;cursor: pointer;">[添加资产]</div>
        </div>
    </div>
    <div style="padding: 10px 30px;">
        <div style="border-bottom: 1px #f0f0f0 solid;width: 100%;padding-bottom: 10px;">
            <h2>基本</h2>
            <div style="display: flex;flex-direction: column;">
                <div class="base_title_content">
                    <span class="base_title_f">主机名*</span>
                    <input type="text" v-model="host" style="resize: none;height: 30px;width: 790px;line-height: 30px;border: 1px solid #d7d7d7;"></input>
                </div>
                <div class="base_title_content">
                    <span class="base_title_f">IP(域名)*</span>
                    <input type="text" v-model="post" style="resize: none;height: 30px;width: 790px;line-height: 30px;border: 1px solid #d7d7d7;"></input>
                </div>
                <div class="base_title_content">
                    <span class="base_title_f">系统平台*</span>
                    <assert-system-selector></assert-system-selector>
                </div>
                <div class="base_title_content">
                    <span class="base_title_f">公网IP</span>
                    <input type="text" v-model="pubHost" style="resize: none;height: 30px;width: 790px;line-height: 30px;border: 1px solid #d7d7d7;"></input>
                </div>
            </div>
        </div>

        <div style="border-bottom: 1px #f0f0f0 solid;width: 100%;padding-bottom: 10px;margin-top: 10px;">
            <h2>协议组</h2>
            <div class="base_title_content" style="height: auto;align-items: flex-start;">
                <span class="base_title_f">协议组</span>
                <div style="display: flex;flex-direction: column;">
                    <div v-for="(item,index) in protoData" style="display: inline-flex;align-items: center;margin-bottom: 5px;">
                        <assert-proto-selector :v-assembly-id="item.protoIndex"></assert-proto-selector>
                        <input type="text" v-model="item.inputValue" style="resize: none;height: 30px;width: 560px;line-height: 30px;border: 1px solid #d7d7d7;"></input>
                        <div v-show="index===(protoData.length-1)" class="add_less_btn_style" style="background-color: #fd9d9f;" @click="onRemoveProtoData(index)">-</div>
                        <div v-show="index===(protoData.length-1)" class="add_less_btn_style" style="background-color: #00b144;" @click="onAddProtoData">+</div>
                    </div>
                </div>
            </div>
        </div>

        <div style="border-bottom: 1px #f0f0f0 solid;width: 100%;padding-bottom: 10px;margin-top: 10px;">
            <h2>认证</h2>
            <div style="display: flex;flex-direction: column;">
                <div class="base_title_content">
                    <span class="base_title_f">账号管理</span>
                    <assert-account-selector></assert-account-selector>
                </div>
            </div>
        </div>

        <div style="width: 100%;padding-bottom: 10px;margin-top: 10px;">
            <h2>其他</h2>
            <div style="display: flex;flex-direction: column;">
                <div class="base_title_content">
                    <span class="base_title_f">状态</span>
                    <input class="btn-switch large" type="checkbox" :checked="state" id="btn-switch-state" @click.prevent="setState">
                </div>
                <div class="base_title_content">
                    <span class="base_title_f">备注</span>
                    <input type="text" v-model="maskStr" style="resize: none;height: 30px;width: 790px;line-height: 30px;border: 1px solid #d7d7d7;"></input>
                </div>
            </div>
        </div>
        <div style="width: 100%;display: flex;justify-content: center;margin-top: 10px;">
            <div class="sure-btn" @click="onSave">保存</div>
        </div>
        
    </div>
</div>

<!-- 主机详情 -->
<div v-else>
    <div style="display: flex;flex-direction: column;height: 40px;border-bottom: 1px #f0f0f0 solid;width: 100%;padding-bottom: 10px;">
        <div style="display: inline-flex;margin-top: 10px;">
            <span style="cursor: pointer;" @click="onChangeState(1)">资产列表</span>
            <span v-show="pageState===3" style="margin-left: 20px;color:#0090cb">资产详情</span>
            <span v-show="pageState===4" style="margin-left: 20px;cursor: pointer;color:#000" @click="onChangeState(3)">资产详情</span>
            <span v-show="pageState===4" style="margin-left: 20px;color:#0090cb">已授权用户</span>
            <span v-show="pageState===3" style="margin-left: 20px;cursor: pointer;color:#000" @click="onChangeState(4)">已授权用户</span>
        </div>
    </div>
    <div v-if="pageState===3" style="width: 100%;margin-top: 10px;display: flex;justify-content: center;">
        <div style="border: 1px solid #d7d7d7;width: 1150px;">
            <div style="border-bottom: 1px solid #d7d7d7;height: 30px;display: flex;align-items: center;">
                <img src="/images/icon_warring.png" width="15px" height="15px" style="margin-left:20px;">
                <span style="font-size: 14px;margin-left: 5px;">基本信息</span>
            </div>
            <div v-for="item in resData" style="margin-top:10px;margin-left:20px;display: inline-flex;">
                <div style="width: 450px;">
                    <span style="font-size: 14px;">{{item.key}}</span>
                </div>
                <div style="width: 670px;margin-left: 10px;">
                    <span style="font-size: 14px;">{{item.value}}</span>
                </div>
            </div>
            <div style="margin-top:10px;margin-left:20px;display: inline-flex;">
                <div style="width: 450px;display: inline-flex;">
                    <span style="font-size: 14px;">更新硬件信息:</span>
                    <div class="sure-btn-min" style="margin-left:30px;" @click="onResRefresh">刷新</div>
                </div>
                <div style="width: 670px;margin-left: 10px;display: inline-flex;">
                    <span style="font-size: 14px;">测试资产可连接性:</span>
                    <div class="sure-btn-min" style="margin-left:30px;" @click="onResTest">测试</div>
                </div>
            </div>
            <div style="width: 100%;height: 30px;"></div>
        </div>
    </div>
    <div v-else>
        <div style="width: 100%;margin-top: 10px;height: 650px;overflow-x: auto; overflow-y: auto;">
            <table id = "tab" class="ui table selectable celled" border="1" style="border-collapse: collapse;">
                <thead>
                    <tr align="center">
                        <th class='table-head-bg' style="width: 340px;" >用户名</th>
                        <th class='table-head-bg' style="width: 310px;" >姓名</th>
                        <th class='table-head-bg' style="width: 400px;" >邮箱</th>
                        <th class='table-head-bg' style="width: 120px;" >操作</th>
                    </tr>
                </thead>
                <tbody id='tableBody'>
                    <tr align="center" style="height: 40px;" v-for="item in userData" >
                        <td>{{item.value1}}</td>
                        <td>{{item.value2}}</td>
                        <td>{{item.value3}}</td>
                        <td>
                            <div class="edit_btn" @click="onDeleteAuthAccount(item.id)">删除</div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>    
    </div>
</div>

<div v-if="bShowhAuth" class="dialog-style" @click.stop>
    <div class="dialog-bg-style" style="display: flex;flex-direction: column;">
        <div style="width: 100%;display: flex;flex-direction: row;justify-content: flex-end;">
            <span style="font-size: 16px;margin-right: 10px;cursor: pointer;" @click="onCloseAuth">X</span>
        </div>
        <span style="font-size: 14px;color:#333;padding: 0 20px;">请输入被授权账号邮箱，多个请以换行符相隔 (不可重复)：</span>
        <textarea style="margin: 5px 20px;width: 400px;height: 170px;border: 1px solid #d7d7d7;resize: none;" v-model="authValue" ></textarea>
        <div style="width: 100%;display: flex;justify-content: center;margin-top: 10px;">
            <div class="sure-btn" @click="onSaveAuth">确认</div>
        </div>
    </div>
</div>

